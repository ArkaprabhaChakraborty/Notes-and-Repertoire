---
description: DNS enumeration, subdomain recon and attacks
---

# DNS Pentest

## Enumeration

### Finding addresses with `host` command

The `host` command is a DNS lookup utility which can be used to find the IP address associated with a hostname. Host is a simple utility for performing DNS lookups. It is normally used to convert names to IP addresses and vice versa.&#x20;

When no arguments or options are given, host prints a short summary of its command-line arguments and options.

```
host google.com
```

```
google.com has address 142.250.183.14
google.com has IPv6 address 2404:6800:4009:820::200e
google.com mail is handled by 10 smtp.google.com.
```

### Using `whois`

WHOIS is a request and response protocol that follows the [RFC 3912](https://www.ietf.org/rfc/rfc3912.txt) specification. A WHOIS server listens on TCP port `43` for incoming requests.&#x20;

The domain registrar is responsible for maintaining the WHOIS records for the domain names it is leasing. `whois` will query the WHOIS server to provide all saved records.

```
whois thmredteam.com
```

After a `whois` lookup, we might get lucky and find names, email addresses, postal addresses, and phone numbers, in addition to other technical information.&#x20;

At the end of the `whois` query, we find the authoritative name servers for the domain in question.



### Finding SOA&#x20;

We can find the SOA record of a nameserver using **`nslookup`**. Consider google.com as an example:&#x20;

```bash
nslookup -type=soa google.com
```

We get a response specifying the primary name server and associated information:

```bash
Non-authoritative answer:
google.com
	origin = ns1.google.com
	mail addr = dns-admin.google.com
	serial = 526409246
	refresh = 900
	retry = 900
	expire = 1800
	minimum = 60
```

### Basic enum with authoritative answers

**An authoritative answer is a response we get directly from the primary DNS server holding the master copy of the zone file.**  To find the authoritative answer for _google.com,_ we execute a new _nslookup_ query in which we specify the primary name server as _`ns1.google.com`._

```bash
nslookup ns1.google.com
```

Upon executing the command, weâ€™ll get the following response, which gives us the addresses of the authoritative server for the specified domain.

```
Non-authoritative answer:
Name:	ns1.google.com
Address: 216.239.32.10
Name:	ns1.google.com
Address: 2001:4860:4802:32::a
```



## Exploitation









