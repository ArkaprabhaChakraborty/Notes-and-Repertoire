# DNS Pentest

## Enumeration

### Finding SOA&#x20;

We can find the SOA record of a nameserver using **`nslookup`**. Consider google.com as an example:&#x20;

```bash
nslookup -type=soa google.com
```

We get a response specifying the primary name server and associated information:

```bash
Non-authoritative answer:
google.com
	origin = ns1.google.com
	mail addr = dns-admin.google.com
	serial = 526409246
	refresh = 900
	retry = 900
	expire = 1800
	minimum = 60
```

### Basic enum with authoritative answers

**An authoritative answer is a response we get directly from the primary DNS server holding the master copy of the zone file.**  To find the authoritative answer for _google.com,_ we execute a new _nslookup_ query in which we specify the primary name server as _`ns1.google.com`._

```bash
nslookup ns1.google.com
```

Upon executing the command, weâ€™ll get the following response, which gives us the addresses of the authoritative server for the specified domain.

```
Non-authoritative answer:
Name:	ns1.google.com
Address: 216.239.32.10
Name:	ns1.google.com
Address: 2001:4860:4802:32::a
```
