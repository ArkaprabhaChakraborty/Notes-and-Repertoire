# NetBIOS Pentest

Attackers use the NetBIOS enumeration to obtain:&#x20;

* The list of computers that belong to a domain&#x20;
* The list of shares on the individual hosts in the network&#x20;
* Policies and passwords

## Enumeration

### Using `nbtstat` utility in Windows

The `nbtstat` utility in Windows displays NetBIOS over TCP/IP (NetBT) protocol statistics, NetBIOS name tables for both the local and remote computers, and the NetBIOS name cache.

#### Get NetBIOS name table of a remote computer

Using the -a flag all the records in NetBIOS name list using the remote host name or NetBIOS name of the computer/target in the NetBIOS network.

```
nbtstat -a <Remote Name>
```

Using the `-A` flag we can dump all records in NetBIOS name list using the IP address of the target.

```
nbtstat -A <IP Address>
```



<table><thead><tr><th width="134">Name</th><th width="152">NetBIOS Code</th><th width="102">Type</th><th>Information Obtained</th></tr></thead><tbody><tr><td>&#x3C;host name></td><td>&#x3C;00></td><td>UNIQUE</td><td>Hostname</td></tr><tr><td>&#x3C;domain></td><td>&#x3C;00></td><td>GROUP</td><td>Domain name</td></tr><tr><td>&#x3C;host name></td><td>&#x3C;03></td><td>UNIQUE</td><td>Messenger service running for the computer</td></tr><tr><td>&#x3C;user name></td><td>&#x3C;03></td><td>UNIQUE</td><td>Messenger service running for the logged-in user</td></tr><tr><td>&#x3C;host name></td><td>&#x3C;20></td><td>UNIQUE</td><td>Server service running</td></tr><tr><td>&#x3C;domain></td><td>&#x3C;1D></td><td>GROUP</td><td>Master browser name for the subnet</td></tr><tr><td>&#x3C;domain></td><td>&#x3C;1B></td><td>UNIQUE</td><td>Domain master browser name, which identifies the primary domain controller (PDC) for the domain</td></tr><tr><td>&#x3C;domain></td><td>&#x3C;1E></td><td>GROUP</td><td>Browser service elections</td></tr></tbody></table>

#### Fetch the contents/names in NetBIOS name cache&#x20;

```
nbtstat -c
```

#### Display the names registered locally&#x20;

The `-n` flag displays the names registered locally by NetBIOS applications such as the server and redirector.

```
nbtstat -n
```

#### Count of all names resolved by a broadcast or WINS server

```
nbtstat -r
```

#### Purges the name cache and reloads all `#PRE`-tagged entries from the `Lmhosts` file

```
nbtstat -R 
```

#### Release and re-register all names with the name server

```
nbtstat -RR
```

#### List the NetBIOS sessions

List the current NetBIOS sessions and their status with the IP addresses

```
nbtstat -S
```

List the NetBIOS sessions table converting destination IP addresses to computer NetBIOS names

```
nbtstat -s
```

Re-displays selected statistics, pausing at each display for the number of seconds specified in Interval

```
nbtstat Interval
```



## Exploitation

